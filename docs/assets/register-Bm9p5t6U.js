import{s as f,B as m,e as g,h as y}from"./boot-DLZHiz98.js";const c=document.querySelector("#register-form"),h=`${m}/auth/register`;function l(r,e="error"){const t=e==="success"?"success":"error",n=document.getElementById("register-msg");if(n){n.style.display="block",n.className=`form-message alert ${t}`,n.textContent=r;return}t==="error"&&alert(r)}function u(r,e){r.setAttribute("aria-busy",String(e)),[...r.querySelectorAll("input, select, textarea, button")].forEach(o=>{(o instanceof HTMLInputElement||o instanceof HTMLButtonElement||o instanceof HTMLTextAreaElement||o instanceof HTMLSelectElement)&&(o.disabled=e)});const n=r.querySelector('button[type="submit"]');n&&(e?(n.dataset.prevText=n.textContent||"",n.textContent="Creatingâ€¦"):(n.textContent=n.dataset.prevText||"Create account",delete n.dataset.prevText))}function p(r,e,t){return!r||!r.includes("@")?"Please enter a valid email address.":!e||e.length<8?"Password must be at least 8 characters.":!t||t.trim().length<2?"Please enter your name.":""}async function S(r){f();try{const e=await fetch(h,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});let t=null;try{t=await e.json()}catch{t=null}if(!e.ok)throw new Error(g(t,"Registration failed"));return t}finally{y()}}function E(r){r.preventDefault();const e=r.target,t=new FormData(e),n=String(t.get("email")||""),o=String(t.get("password")||""),a=String(t.get("name")||""),i=p(n,o,a);if(i){l(i,"error");return}const d={email:n,password:o,...a&&{name:a}};u(e,!0),S(d).then(()=>{const s=encodeURIComponent("Account created! You can now log in.");window.location.href=`login.html?registered=1&notice=${s}`}).catch(s=>{l(s&&s.message||"Could not register.","error")}).finally(()=>{u(e,!1)})}c&&c.addEventListener("submit",E);
